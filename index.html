<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#148eff">
    <meta name="description" content="Best of the best Snake game">
    <title>Snake</title>
    <link rel="manifest" href="manifest.json" />
    <link rel="stylesheet" href="style/style.css" />
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker
            .register('sw.js',)
            .then(reg => {
              // console.log(reg);
            })
            .catch(err => {
              // console.log(err);
              const div = document.createElement('div');
              div.innerText = 'serviceWorker not registred';
              document.body.appendChild(div);
            });
        });
      } else {
        const div = document.createElement('div');
        div.innerText = 'serviceWorker not supported';
        document.body.appendChild(div);
      }
    </script>
   
    <script src="js/sourceLoader.js"></script>
  </head>
  <body>
    <canvas id="canvas"></canvas>
    <button id="promptBtn" type="button">Install me</button>
    <button id='notifications' type="button">Notification</button>
    <section class="control__wrap">
      <button
        type="button"
        class="control left"
        onclick="changeWay(event, 'ArrowLeft')"
      >
        Left
      </button>
      <button
        type="button"
        class="control right"
        onclick="changeWay(event, 'ArrowRight')"
      >
        Right
      </button>
      <button id="notifications_two" type="button">Notification</button>
      <button
        type="button"
        class="control top"
        onclick="changeWay(event, 'ArrowUp')"
      >
        Top
      </button>
      <button
        type="button"
        class="control down"
        onclick="changeWay(event, 'ArrowDown')"
      >
        Down
      </button>
    </section>
    <script src="js/game.js"></script>
    <script src="js/push.js"></script>
    <script>
      let defferredPrompt;
      const promptBtn = document.getElementById('promptBtn');
      window.addEventListener('beforeinstallprompt', e => {
        e.preventDefault();
        defferredPrompt = e;
        promptBtn.style.display = 'block';
      });
      promptBtn.addEventListener('click', e => {
        defferredPrompt.prompt();
        defferredPrompt.userChoice.then(choiceResult => {
          if (choiceResult.outcome === 'accepted') {
          }
          defferredPrompt = null;
        });
      });
      window.addEventListener('appinstalled', evt => {
        requestPush().then(result =>{
          // setTimeout(showNotification, 10000)
        }).catch(result =>{
          alert(result)
        })
      });
    </script>
  </body>
</html>
